# Import whatever you need here.
# If you are using something that is needed to
# be install, please contact the framework maintainer.
from pwn import *
import requests
import threading

class Exploit(threading.Thread):

    def __init__(self):
        threading.Thread.__init__(self)
        self.fname = __file__

        # which service to exploit
        self.target = "game1"
        
        # the priority to use this exploit,
        # integer from 1 to 100, 1 has the top priority
        self.level = 1
        
        # Author of the exploit to contact
        self.author = "n0b0dy"
        

    def do_attack(self, ip, port):
        # Write your exploit here and return the flag
        return "flag{fake_flag1-1_" + str(ip) + ":" + str(port) + "}"

    
    def attack(self, ip, port):
        ret = ""
        try:
            ret = self.do_attack(ip, port)
        except Exception as e:
            ret = ""
        return ret

    def set(self, ip, port, submitter):
        self.ip = ip
        self.port = port
        self.submitter = submitter

    def run(self):
        try:
            flag = self.do_attack(self.ip, self.port)
            self.submitter.add(flag, self.ip, self.port, self.name())
        except Exception as e:
            pass


    def __str__(self):
        return "[EXP] {name}".format(name=self.name())

    def name(self):
        if self.fname.endswith(".py"):
            return self.fname[:-3]
        elif self.fname.endswith(".pyc"):
            return self.fname[:-4]
        return self.fname
